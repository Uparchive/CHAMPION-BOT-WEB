// ═══════════════════════════════════════════════════════════════
// REGRAS DE SEGURANÇA DO FIRESTORE
// Champion Bot - Banco de Dados
// ═══════════════════════════════════════════════════════════════

rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // ════════════════════════════════════════════════════════════
    // COLEÇÃO: users (Usuários do Sistema)
    // ════════════════════════════════════════════════════════════
    
    match /users/{userId} {
      // MODO DESENVOLVIMENTO: Permite tudo temporariamente
      // TODO: Depois de migrar dados, ativar regras de segurança
      allow read, write: if true;
      
      // PRODUÇÃO (comentado por enquanto):
      // allow read: if request.auth != null;
      // allow create: if true;
      // allow update: if request.auth != null && (
      //   resource.data.email == request.auth.token.email ||
      //   get(/databases/$(database)/documents/users/$(request.auth.uid)).data.isAdmin == true
      // );
      // allow delete: if request.auth != null && 
      //   get(/databases/$(database)/documents/users/$(request.auth.uid)).data.isAdmin == true;
    }
    
    // ════════════════════════════════════════════════════════════
    // COLEÇÃO: sessions (Sessões Ativas) - OPCIONAL
    // ════════════════════════════════════════════════════════════
    
    match /sessions/{sessionId} {
      allow read, write: if true;
    }
    
    // ════════════════════════════════════════════════════════════
    // COLEÇÃO: logs (Logs de Atividades) - OPCIONAL
    // ════════════════════════════════════════════════════════════
    
    match /logs/{logId} {
      allow read, write: if true;
    }
    
    // ════════════════════════════════════════════════════════════
    // REGRA PADRÃO: Negar tudo que não foi especificado acima
    // ════════════════════════════════════════════════════════════
    
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
